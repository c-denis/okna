# CRM для сервиса оконных ремонтов "Окна"

Простая и эффективная CRM-система для управления заявками на ремонтные услуги с интеграцией Telegram для уведомлений.

## Ключевая информация
- **Цель**: Автоматизация работы с заявками (создание, назначение, отслеживание статусов)
- **Основные пользователи**: 
  - Операторы (создание заявок)
  - Координаторы (назначение мастеров)
  - Мастера (отметки о выполнении)
  - Администраторы (отчеты и управление)
- **Технологии**:
  - Frontend: Vue.js
  - Backend: Django (Python)
  - БД: PostgreSQL
  - Уведомления: Telegram Bot API

## Структура проекта

okna/
├── backend/ # Django-приложение
│ ├── api/ # API endpoints
│ ├── models/ # Модели данных
│ ├── management/ # CLI-команды
│ └── ...
├── frontend/ # Vue.js приложение
│ ├── src/
│ │ ├── components/ # UI-компоненты
│ │ ├── views/ # Страницы
│ │ └── ...
│ └── ...
├── telegram_bot/ # Сервис уведомлений
├── docker-compose.yml # Конфигурация контейнеров
└── README.md


## Реализовано по ТЗ
✅ **Основной функционал заявок**:
- Создание заявок с полями: ФИО клиента, телефон, адрес, комментарий
- Назначение мастеров с проверкой на занятость (не более 1 заявки)
- 5 статусов заявок: "Не назначена", "Назначена", "В работе", "Исполнена", "Отказ"
- Цветовая индикация статусов в интерфейсе

✅ **Управление пользователями**:
- Ролевая модель (оператор, координатор, мастер, администратор)
- Статусы мастеров с цветовой индикацией

✅ **Уведомления**:
- Telegram-бот для оповещений о новых заявках
- Формат: "Новая заявка №155026 (14:01)\nКлиент: Ника Дмитриевна\nАдрес: ул. Белорусская, д. 34, кв. 3"

✅ **Отчетность**:
- Сводные отчеты по локациям
- Готовые периоды: сегодня/неделя/месяц

## Требуется реализовать
🔧 **По текущему ТЗ**:
- [ ] Интеграция черного списка клиентов
- [ ] Подтверждение резервного копирования БД
- [ ] Фиксация времени входа/выхода мастера
- [ ] Валидация телефона при создании заявки

## План развития
📅 **Будущие улучшения**:
- **Безопасность**:
  - Двухфакторная аутентификация для админов
  - Система логирования критичных действий
- **Производительность**:
  - Оптимизация запросов к БД (индексы)
  - Кэширование частых запросов
- **Интеграции**:
  - API для мобильного приложения (отметки о входе/выходе)
- **Доп. функционал**:
  - История изменений заявок
  - Гибкие фильтры в отчетах

## Установка и запуск
```bash
docker-compose up -d

Доступ к интерфейсу: http://localhost:8080


Ключевые особенности:
1. Четкое разделение на реализованное/нереализованное
2. План развития вынесен отдельным блоком с вашими правками
3. Добавлена визуальная индикация статусов (✅/🔧)
4. Упрощены технические детали там, где это не критично
5. Включена базовая инструкция по запуску

Файл готов к размещению в корне репозитория. При необходимости можно добавить больше технических деталей в раздел установки.

okna/
├── .gitignore                    # Игнорируемые файлы для Git
├── .env                          # Переменные окружения (SECRET_KEY, DB_URL, TELEGRAM_TOKEN)
├── docker-compose.yml            # Конфигурация контейнеров (Django, Vue, PostgreSQL, Redis)
├── README.md                     # Основная документация
│
├── backend/                      # Django-приложение
│   ├── __init__.py
│   ├── asgi.py                   # ASGI-конфигурация
│   ├── wsgi.py                   # WSGI-конфигурация
│   ├── settings/                 # Настройки (разделены по средам)
│   │   ├── base.py               # Базовые настройки
│   │   ├── production.py         # Продакшен-конфиг
│   │   └── development.py        # Дев-конфиг
│   │
│   ├── api/                      # API v1
│   │   ├── __init__.py
│   │   ├── urls.py               # Все маршруты API
│   │   ├── schemas/              # Схемы Pydantic
│   │   │   ├── order.py          # Валидация заявок
│   │   │   └── user.py           # Валидация пользователей
│   │   │
│   │   ├── views/                # Представления
│   │   │   ├── auth.py           # Аутентификация
│   │   │   ├── orders.py         # CRUD заявок
│   │   │   ├── users.py          # Управление пользователями
│   │   │   ├── locations.py      # Локации
│   │   │   └── reports.py        # Отчеты (XLSX/PDF)
│   │   │
│   │   └── tests/                # API-тесты
│   │       ├── test_orders.py
│   │       └── test_users.py
│   │
│   ├── apps/                     # Django-приложения
│   │   ├── core/                 # Ядро системы
│   │   │   ├── models.py         # Базовые модели
│   │   │   └── utils.py          # Утилиты (валидаторы)
│   │   │
│   │   ├── orders/               # Заявки
│   │   │   ├── models.py         # Модель Order
│   │   │   ├── admin.py          # Админка
│   │   │   └── signals.py        # Сигналы (уведомления)
│   │   │
│   │   └── users/                # Пользователи
│   │       ├── models.py         # Custom User Model
│   │       └── permissions.py    # Права доступа
│   │
│   ├── config/                   # Конфигурация
│   │   ├── celery.py             # Celery (асинхронные задачи)
│   │   └── cache.py              # Кэширование (Redis)
│   │
│   ├── db/                       # Работа с БД
│   │   ├── fixtures/             # Фикстуры
│   │   └── seeders.py            # Наполнение тестовыми данными
│   │
│   ├── libs/                     # Внешние библиотеки
│   │   └── telegram_api/         # Кастомная обертка для Telegram API
│   │
│   ├── locale/                   # Локализации
│   │   └── ru/                   # Русский язык
│   │
│   ├── management/               # CLI-команды
│   │   ├── commands/
│   │   │   ├── backup_db.py      # Резервное копирование
│   │   │   ├── create_admin.py   # Создание админа
│   │   │   └── send_alerts.py    # Проверка уведомлений
│   │   └── utils.py              # Утилиты для команд
│   │
│   ├── migrations/               # Миграции БД
│   │   └── 0001_initial.py       # Первичные миграции
│   │
│   ├── static/                   # Статика
│   │   ├── css/                  # Глобальные стили
│   │   └── images/               # Изображения (логотипы)
│   │
│   ├── templates/                # Шаблоны (для email)
│   │   └── emails/               # Письма
│   │       ├── alert.html        # Шаблон уведомления
│   │       └── base.html         # Базовый шаблон
│   │
│   ├── requirements/             # Зависимости
│   │   ├── base.txt              # Основные
│   │   ├── dev.txt               # Для разработки
│   │   └── prod.txt              # Для продакшена
│   │
│   └── utils/                    # Вспомогательные скрипты
│       ├── logging.py            # Настройка логов
│       └── security.py           # Хелперы безопасности
│
├── frontend/                     # Vue 3 + Vite
│   ├── public/                   # Публичные файлы
│   │   ├── favicon.ico
│   │   └── index.html            # Точка входа
│   │
│   ├── src/
│   │   ├── assets/               # Ресурсы
│   │   │   ├── fonts/            # Шрифты
│   │   │   └── scss/             # Глобальные стили
│   │   │
│   │   ├── components/           # Компоненты UI
│   │   │   ├── app/
│   │   │   │   ├── AppHeader.vue # Шапка
│   │   │   │   └── AppSidebar.vue # Меню
│   │   │   │
│   │   │   ├── orders/
│   │   │   │   ├── OrderCard.vue # Карточка заявки
│   │   │   │   └── OrderForm.vue # Форма создания
│   │   │   │
│   │   │   └── ui/
│   │   │       ├── StatusBadge.vue # Бейдж статуса
│   │   │       └── DatePicker.vue  # Выбор даты
│   │   │
│   │   ├── composables/          # Композаблы Vue 3
│   │   │   ├── useApi.js         # HTTP-клиент
│   │   │   └── useAuth.js        # Логика авторизации
│   │   │
│   │   ├── router/               # Маршруты
│   │   │   └── index.js          # Конфигурация роутера
│   │   │
│   │   ├── stores/               # Pinia-сторе
│   │   │   ├── orders.js         # Стор заявок
│   │   │   └── users.js          # Стор пользователей
│   │   │
│   │   ├── views/                # Страницы
│   │   │   ├── AuthView.vue      # Авторизация
│   │   │   ├── OrdersView.vue    # Список заявок
│   │   │   ├── ReportView.vue    # Отчеты
│   │   │   └── UserProfile.vue   # Профиль
│   │   │
│   │   ├── App.vue               # Корневой компонент
│   │   └── main.js               # Инициализация приложения
│   │
│   ├── .eslintrc.js              # Линтер
│   ├── jsconfig.json             # Конфиг JavaScript
│   ├── package.json              # Зависимости npm
│   └── vite.config.js            # Конфиг сборки
│
├── infra/                        # Инфраструктура
│   ├── nginx/                    # Конфиг Nginx
│   │   └── default.conf
│   │
│   ├── postgres/                 # Конфиг PostgreSQL
│   │   └── init.sql              # Инициализация БД
│   │
│   └── scripts/                  # Скрипты развертывания
│       ├── deploy.sh             # Деплой
│       └── migrate.sh            # Применение миграций
│
├── telegram_bot/                 # Бот для уведомлений
│   ├── __init__.py
│   ├── bot.py                    # Основной скрипт
│   ├── handlers/                 # Обработчики
│   │   ├── commands.py           # CLI-команды
│   │   └── notifications.py      # Логика уведомлений
│   │
│   ├── services/                 # Сервисы
│   │   └── order_notifier.py     # Уведомления о заявках
│   │
│   ├── tests/                    # Тесты
│   │   └── test_handlers.py
│   │
│   └── requirements.txt          # Зависимости бота
│
└── tests/                        # Интеграционные тесты
    ├── e2e/                      # End-to-end тесты
    │   └── orders.test.js        # Тесты заявок
    │
    └── unit/                     # Юнит-тесты
        ├── frontend/             # Тесты Vue
        └── backend/              # Тесты Django